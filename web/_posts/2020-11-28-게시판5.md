# 게시판5) 게시판 화면 구성

- 드디어 본론, 게시판을 만들 것이다. index 에서 게시판을 클릭하면 보이는 게시판 페이지를 구성하려고 한다.

# home 버튼 누르면 index로 돌아가기

- **${pageContext.request.contextpath}/**

```jsp
<div class= "home">
    <!-- spring - appservlet 에 servelt-context에서 설정을 해주어서 이렇게 해줄 수 있다. -->
    <a href="${pageContext.request.contextPath}/"><image src = "images/home.jpg" style = "width : 30px; height : 30px;"></a></div>
```

# DB에서 받은 정보 출력

- jstl core library를 이용해 &lt;c:forEach 문 사용

```jsp
<table border="1">
    <tr>
        <th>번호</th>
        <th class="title">글제목</th>
        <th>글쓴이</th>
        <th>글쓴날</th>
        <th>조회수</th>
    </tr>
    <c:forEach var= "board" items="${list}" varStatus="status">
        <tr>
            <td>${board.boardseq}</td>
            <td>
                <!-- javascript 호출하는걸로 바꾼다... -->
                <a href="javascript:boardDetail(${board.boardseq})">${board.title}</a>
            </td>
            <td>${board.userid }</td>
            <td>${board.regdate} </td>
            <td>${board.hitcount}</td>
        </tr>
    </c:forEach>
</table>
```

# 로그인 했을시에만 글쓰기 가능

- **&lt;c: if test** 
- **${sessionScope.loginId}**

```jsp
<c:if test = "${not empty sessionScope.loginId }">
    <div class = "write">
        <a href = "boardwrite">글쓰기</a>
    </div>
</c:if>
```

# 글 검색

- **${searchItem=='title' ? 'selected' : ' '}** 이런 형식으로 사용해 서버에 저장된 변수 값을 읽어와 화면에 설정이 남아있게 할 수 있다.

```jsp
<form id = "search" action = "boardlist" method = "GET">
    <select name = "searchItem">
        <option value = "title"  ${searchItem=='title' ? 'selected' : ' '}>제목</option>
        <option value = "userid" ${searchItem=='userid' ? 'selected' : ' ' }>작성자 </option>
        <option value = "message" ${searchItem=='message' ? 'selected' : ' '}>글내용 </option>
    </select>
    <input type= "text" name = "searchWord" value = "${searchWord }">
    <input type= "submit" value = "검색">
</form>
```

- index페이지코드 재사용

**controller**

```java
@RequestMapping("/boardlist")
public String boardList(
    @RequestParam(value="searchItem", defaultValue ="title") String searchItem, 
    @RequestParam(value="searchWord", defaultValue ="") String searchWord,
    Model model) {


    System.out.println(searchItem +":"+searchWord );
    List<Board> list = repository.boardList(searchItem,searchWord);//글 목록 조회
    model.addAttribute("list",list);
    model.addAttribute("searchItem", searchItem);
    model.addAttribute("searchWord", searchWord);

    return "board/boardList";
}
```

- choose when 으로 조건을 걸어준다. (switch case 문 처럼 사용하면 된다.)
- LIKE '%' ||  #{searchWord} || '%'

```xml
<select id = "boardList" resultType="Board" parameterType = "map">
    SELECT 
    boardseq,userid, title,message,to_char(regdate,'YYYY-MM-DD') as regdate
    ,hitcount, originalfile, savedfile
    FROM 
    BOARD
    WHERE
    <choose>
        <when test = "searchItem=='title'">title</when>
        <when test = "searchItem=='userid'">userid</when>
        <when test = "searchItem=='message'">message</when>
    </choose>
    LIKE '%' ||  #{searchWord} || '%'
    ORDER BY boardseq DESC
</select>
```



**repository**

```java
public List<Board> boardList(String searchItem, String searchWord) {
    Map<String,String> map = new HashMap<String,String>();
    BoardMapper mapper =  session.getMapper(BoardMapper.class);

    map.put("searchItem",searchItem);
    map.put("searchWord",searchWord);
    List<Board> list = mapper.boardList(map);
    return list;
}
```



# 페이징

- 아직

```jsp
<!-- 페이징 -->
<div class = "navigator">
    ◁  1  2  3  4  5  ▷
</div>
```

