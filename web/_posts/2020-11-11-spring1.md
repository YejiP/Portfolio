# 서버로 데이터 전송하기

- 이 글에서는 서버로 데이터를 전송하는 다섯가지 방법을 알아볼 것이다.

```
1. 태그로 전송
2. GET method로 전송
3. POST method로 전송
4. input button으로 전송
5. submit으로 전송
```

![그림요약](https://user-images.githubusercontent.com/37058233/99193205-cc4e0e80-27ba-11eb-9411-54dcbbdd378b.PNG)

## 들어가기에 앞서 - 필독

- controller 클래스 위에는  **@Controller**를 붙여준다.

- **java 파일** : 글 예시에 등장하는 java 함수는 모두 controller 클래스 안에 들어있다. 

  ```java
  @Controller
  public class ReceivedController {
      @RequestMapping(value = "/send1", method = RequestMethod.GET)
      public String send1(params1, params2...) {
          //code
          return "jsp 파일 이름";
      }
  ```

  ![jspNjava](https://user-images.githubusercontent.com/37058233/99234068-681d6000-2837-11eb-8f62-f1f02950f91c.PNG)

- **jsp 파일**에서 정보를 넘길 url을 설정해 주고 ("send1"로 설정)

  ```jsp
  <a href="send1?username=suarez&userage=34">1. 태그로 전송</a><br>
  ```


-  **java**에서 아래와 같이 받아준다.

  ```java
  @RequestMapping(value="/send1", method=RequestMethod.GET)
  public string send1(params1, params2...){
      //code
      return "jsp 파일 이름";
  }
  ```

- **@RequestMapping(value ="/send1" , method=RequestMethod.GET)**

  - value 값에는 mapping url을 입력한다. 
  - method에는 RequestMethod.GET 와 RequestMethod.POST 를 쓸 수 있다.

- 아래 다섯가지 예시를 통해 눈에 익히도록 하자.

## 1번 방법 : 태그로 전송

- 태그로 전송을 누르면 서버로 정보를 전송해서 서버로 부터 받은 데이터에 정보를 출력하도록 할 수 있다

- a태그에 **"method명?key1=value1&key2=value2"** 이런 식으로  입력해서 서버에 값을 전달해 줄 수 있다.

  &lt;a href="**send1?username=suarez&userage=34**">1. 태그로 전송</a&gt;

  - 서버에 username 과 userage 정보가 넘어간다.

```jsp
<!--jsp 파일-->
<a href="send1?username=suarez&userage=34">1. 태그로 전송</a><br>
```

![태그jsp](https://user-images.githubusercontent.com/37058233/99228143-91d28900-282f-11eb-882f-378c232a8e8a.PNG)

- **@RequestMapping(value="/send1", method=RequestMethod.GET)**

- 함수에 parameter가 있어서 jsp에서 보낸 정보를 받을 수 있다. 

- 이 정보를 jsp에서 또 읽어오기 위해 **Model 객체에 저장**을 한다. 

  ```java
  model.addAttribute("name",username)
  ```

- return에 jsp 페이지 이름을 적어주고, 처리를 끝난 후 그 페이지를 보여준다.

- 이 함수는 controller 클래스 안에 들어가있다.

```java
@RequestMapping(value="/send1", method=RequestMethod.GET)
public String send1(String username, int userage, Model model) {    			     		model.addAttribute("name", username);
    model.addAttribute("age", userage);
    return "index";
}
```

![a태그](https://user-images.githubusercontent.com/37058233/99228140-9139f280-282f-11eb-8c7c-ae6d8cce531a.PNG)

- **jsp 파일**에서 **${변수명}**-el표기법 을 이용해 서버의 정보를 가져올 수 있다. 

```jsp
<span>서버로부터 받은 데이터 : ${name}, ${age}</span> <!--el 표기법-->
```

## 2번 방법: GET method로 전송

- **jsp**파일에서 **form action ="mapping url"** 로 java 함수와 매핑해준다.

- method 에는 GET을 준다.

- name에 있는 정보가 키로, value에 있는 정보가 값으로 서버에 넘어간다.

  ```jsp
  <form action="send2" method="GET">
      <input name="변수명" value = "값">
  </form>
  ```

**jsp**

- method = "GET" 방법으로 서버에 정보를 요청한다. 

<img width="257" alt="1111sp5" src="https://user-images.githubusercontent.com/37058233/99238966-c5b4ab00-283d-11eb-8fd0-8cb04357d5e8.PNG">

- 아래 주소창에 jsp에서 넘긴 데이터가 다 보인다.

<img width="430" alt="1111sp6" src="https://user-images.githubusercontent.com/37058233/99238965-c51c1480-283d-11eb-95ab-6b6bd478f44a.PNG">

```jsp
<form action="send2" method="GET">
    <label for="username"><input type="text" id="username" name="username" ></label><br>
    <label for="userage"><input type="text" id="userage" name="userage"></label><br>
    <input type="submit" value="전송">
</form>
```

**java** 

@RequestMapping("/send2")에 GET 메소드는 굳이 적어주지 않아도 된다.

```java
@RequestMapping("/send2")
public String send2(String username, int userage, Model model) {
    model.addAttribute("name", username);
    model.addAttribute("age", userage);
    return "index";
}
```

## 3번 방법: POST 방식으로 전송하기

- **jsp**파일에서 **form action ="mapping url"** 로 java 함수와 매핑해준다.

- method 에는 POST를 준다.

- name에 있는 정보가 키로, value에 있는 정보가 값으로 서버에 넘어간다.

  ```jsp
  <form action="send2" method="POST">
      <input name="변수명" value = "값">
  </form>
  ```

**jsp**

- method = "POST" 방법으로 서버에 정보를 요청한다.

  ​														 <img width="303" alt="1111sp7" src="https://user-images.githubusercontent.com/37058233/99239592-9ce0e580-283e-11eb-98ab-a327740e9db3.PNG">

- POST 방식을 사용하면 jsp에서 서버에 넘긴 정보가 보이지 않는다.

  <img width="290" alt="1111sp8" src="https://user-images.githubusercontent.com/37058233/99239589-9bafb880-283e-11eb-9c69-42a6010e5275.PNG">

```jsp
<form action="send3" method="POST">
    <label for="username"><input type="text" id="username" name="username" ></label><br>
    <label for="userage"><input type="text" id="userage" name="userage"></label><br>
    <input type="submit" value="전송">
</form>
```

- POST는 **@RequestMapping(value="/send3", method=RequestMethod.POST)** 이렇게 써줘야한다.

```java
@RequestMapping(value="/send3", method=RequestMethod.POST)
public String send3(String username, int userage, Model model) {
    model.addAttribute("name", username);
    model.addAttribute("age", userage);
    return "index";
}
```

## 4번 방법: JS로 정보 넘기기 - button

<img width="394" alt="1111sp9" src="https://user-images.githubusercontent.com/37058233/99240932-85a2f780-2840-11eb-98c6-ef418339e6fb.PNG">

```jsp
<input id="btn" type="button" value="데이터 전송" ><br>
<p>${userid}, ${hobby}</p>  
```

- 버튼을 누르면 javascript에서 서버에 정보를 넘기는 코드가 실행된다.

- location 은 주소창 객체를 의미한다. 이 주소창 객체의 href 속성에 직접 값을 줘서 넘긴다.

  ```javascript
  location.href = "send4?userid=asdf&hobby=Cooking";
  ```

- 다음과 같은 코드.

```javascript
window.onload = function() {
    document.getElementById("btn").onclick = function() {
        var userid = "asdf";
        var hobby =  "Cooking";
        if(confirm("데이터를 전송하시겠습니까?")) {
            location.href = "send4?userid="+ userid +"&hobby=" + hobby;
            alert("전송완료");
        }
    };
```

<img width="428" alt="1111sp10" src="https://user-images.githubusercontent.com/37058233/99240928-83d93400-2840-11eb-9733-e963263262f6.PNG">

```java
@RequestMapping(value="/send4", method=RequestMethod.GET)
public String send4(String userid, String hobby, Model model) {
    model.addAttribute("userid", userid);
    model.addAttribute("hobby", hobby);
    return "index";
}
```

## 5번 방법: input submit으로 정보 넘기기

- type= submit으로 한 경우 button과는 다르게 location.href에 직접 정보를 넘기지 않아도 된다.
- 일단 화면은 다음과 같다.

<img width="393" alt="1111sp11" src="https://user-images.githubusercontent.com/37058233/99242489-a4a28900-2842-11eb-8995-6b60b11aee44.PNG">

```jsp
<form action="send5" method="GET">
    <label for="userid">아이디 : <input type="text" id="userid" name="userid" ></label><br>
    <label for="hobby">취 미 : <input type="text" id="hobby" name="hobby"></label><br>
    <input id="btn5" type="submit" value="전송">
</form>		
```

- js에서 변수이름을 java 함수이름의 parameter와 같이 해서 값을 넘길 수 있다.

```javascript
window.onload = function() {
    document.getElementById("btn5").onclick = function() {
        var userid = document.getElementById("userid").value;
        var hobby  = document.getElementById("hobby").value;

        if(confirm("데이터를 전송할까요?")) {
            alert("전송 완료");
            return true; // submit을 하라는 의미 (input type="submit" 동작을 계속 하라는 의미)
        }
        alert("전송 취소");
        return false; // submit을 하지 말라는 의미

    };
};
```

<img width="439" alt="1111sp12" src="https://user-images.githubusercontent.com/37058233/99242514-ab310080-2842-11eb-9073-4046a4b7d63e.PNG">

```java
@RequestMapping(value="/send5",method= RequestMethod.GET)
public String send5(String userid, String hobby,Model model) {
    model.addAttribute("userid",userid);
    model.addAttribute("hobby",hobby);
    return "index";
}
```





<hr>

**전체코드**

- **index.jsp**

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>parameter 전송</title>
<script>
	window.onload = function() {
		document.getElementById("btn").onclick = function() {
			var userid = "asdf";
			var hobby =  "Cooking";

			if(confirm("데이터를 전송하시겠습니까?")) {
				location.href = "send4?userid="+ userid +"&hobby=" + hobby;
				alert("전송완료");
			}
			
		};
		document.getElementById("btn5").onclick = function() {
			var userid = document.getElementById("userid").value;
			var hobby  = document.getElementById("hobby").value;

			if(confirm("데이터를 전송할까요?")) {
				alert("전송 완료!!!!");
				return true; // submit을 하라는 의미 (input type="submit" 동작을 계속 하라는 의미)
			}
			alert("전송 취소");
			return false; // submit을 하지 말라는 의미
			
		};
	};
</script>
</head>
<body>
<div class="wrapper">
	<h1>파라미터 전송 1</h1>
	<ul>
		<li>
			<a href="send1?username=suarez&userage=34">1. 태그로 전송</a><br>
			<span>서버로부터 받은 데이터 : ${name}, ${age}</span> <!-- EL 표현식 -->
		</li>
		<li>
			<form action="send2" method="GET">
				<label for="username"><input type="text" id="username" name="username" ></label><br>
				<label for="userage"><input type="text" id="userage" name="userage"></label><br>
				<input type="submit" value="전송">
			</form>
		</li>
		<li>
			<form action="send3" method="POST">
				<label for="username"><input type="text" id="username" name="username" ></label><br>
				<label for="userage"><input type="text" id="userage" name="userage"></label><br>
				<input type="submit" value="전송">
			</form>
		</li>
	</ul>
	<hr>
	<h1>파라미터 전송 2(Javascript 이용)</h1>
	<ul>
		<li>
			<input id="btn" type="button" value="데이터 전송" ><br>
			<p>${userid}, ${hobby}</p>
		</li>
		<li>
			<form action="send5" method="GET">
				<label for="userid">아이디 : <input type="text" id="userid" name="userid" ></label><br>
				<label for="hobby">취 미 : <input type="text" id="hobby" name="hobby"></label><br>
				<input id="btn5" type="submit" value="전송">
			</form>		
		</li>
	</ul>
</div>
</body>
</html>
```

- **mainController.java**

```java
package sesoc.intern.guestbook1;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
public class MainController {
    @RequestMapping(value="/",method= RequestMethod.GET)
    public String index() {
        return "index";
    }
}
```

- **receivedController.java**

```java
package sesoc.intern.guestbook1;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
public class ReceivedController {
    @RequestMapping(value = "/send1", method = RequestMethod.GET)
    public String send1(String username, int userage, Model model) {
        model.addAttribute("name",username);
        model.addAttribute("age",userage);
        return "index";
    }
    @RequestMapping(value="/send2",method= RequestMethod.GET)
    public String send2(String username, int userage,Model model) {
        model.addAttribute("name",username);
        model.addAttribute("age",userage);
        return "index";
    }
    @RequestMapping(value="/send3",method= RequestMethod.POST)
    public String send3(String username, int userage,Model model) {
        model.addAttribute("name",username);
        model.addAttribute("age",userage);
        return "index";
    }
    @RequestMapping(value="/send4",method= RequestMethod.GET)
    public String send4(String userid, String hobby,Model model) {
        model.addAttribute("userid",userid);
        model.addAttribute("hobby",hobby);
        return "index";
    }
    @RequestMapping(value="/send5",method= RequestMethod.GET)
    public String send5(String userid, String hobby,Model model) {
        model.addAttribute("userid",userid);
        model.addAttribute("hobby",hobby);
        return "index";
    }
}
```

