---
layout: post
title: AWS CLI ,SDK, IAM roles
description: >
  CLI
excerpt_separator: <!--more-->
---

# AWS CLI ,SDK, IAM roles

# CLI

## Setup

AWS CLI 를 window에서 사용하는 법은 간단하다. 여기서 https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2-windows.html aws에서 MSI installer 로 설치하면 된다. 

그 후 cmd에서 aws --version 하면 이렇게 뜬다.

![CLI_setup](https://user-images.githubusercontent.com/37058233/95748289-bd180480-0cd4-11eb-86a8-296ee76e964f.PNG)



## CLI installation Troubleshooting

  aws:command not found
    the aws executable 이 PATH env variable에 없다.
    (PATH 는 너의 aws 실행파일이 어디있는지 시스템에게 알려주는 역할을 한다.)


## AWS CLI configuration

- ### 개인컴일 때

IAM 서비스에서 users  => security credentials 가서 create access key. 

![createAccessKey](https://user-images.githubusercontent.com/37058233/95749732-00737280-0cd7-11eb-82b5-7439e537bd6e.PNG)

download .csv file 한다. 이 파일은 super secret임.

![download](https://user-images.githubusercontent.com/37058233/95749778-11bc7f00-0cd7-11eb-8650-ca417258a960.PNG)

*주의 !  절대 ec2 머신에서 하지 말것. ec2 머신에 personal credentials 넣는거 안좋다.*



command line 에서 aws configure 치면, 다음을 차례로 입력해 주면 된다.

```
AWS Access Key ID [None] : [여기 access key 입력]
AWS secret Access Key ID [None] : [여기 secret access key 입력]
Default region name [None] : [여기 region 입력]
```



- ### EC2 instance 일 때

앞서 한 것 처럼하면 아주 큰일 난다. EC2 Instance에 이런 중요한 정보 업로드하면 안된다. 대신, IAM ROLE을 이용한다.

ec2 머신에 ssh 접속한다. 
aws configure

```
AWS Access Key ID [None] : [엔터]
AWS secret Access Key ID [None] : [엔터]
Default region name [None] : [여기 region 입력]
```

IAM 롤에 가서 , create role 한다. aws service => ec2 => policy 찾는다. 

![iam role](https://user-images.githubusercontent.com/37058233/95750685-788e6800-0cd8-11eb-8fe6-f0409d915b05.PNG)



내가 만약 이 ec2 instance에 s3 에 접속 권한을 주고 싶으면, AmazonS3ReadOnlyAccess를 선택하고
role name과 description 써준다.  그리고 next 누르면 끝. 

EC2 management 콘솔에 가서 instance setting, attach/replace IAM role 에서 내가 방금 만든 role을 attach 해준다. 

그럼 해결~~~